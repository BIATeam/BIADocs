---
layout: default
title: Framework from v3.4.2 to v3.5.0
parent: Migrate an existing project
nav_order: 1
---
# Framework from v3.4.2 to v3.5.0

## WARNING POTENTIAL BUG 

## AUTOMATIC MIGRATION
1. Use the BIAToolKit to migrate the project

2. Manage the confict (2 solutions)
   1. In BIAToolKit click on "4 - merge Rejected" and search "<<<<<" in all files.  
    * Resolve the conflit manualy.
   2. Analyse the .rej file (search "diff a/" in VS code) that have been created in your project folder
     * Apply manualy the change.

3. Apply other manual step (describe bellow) at the end if all is ok, you can remove the .rej files (durring the process they can be usefull to resolve build probleme) 

4. Change source path and run the script [V3.5.2_to_V3.6.0_Replacement.ps1](./Scripts/V3.5.2_to_V3.6.0_Replacement.ps1) 

5. The bia dommain and features have change:
   replace /domains/app-settings/ by /domains/bia-domains/app-settings/
   replace /domains/language-option/ by /domains/bia-domains/language-option/
   replace /domains/notification/ by /domains/bia-domains/notification/
   replace /domains/notification-type-option/ by /domains/bia-domains/notification-type-option/
   replace /domains/role-option/ by /domains/bia-domains/role-option/
   replace /domains/team/ by /domains/bia-domains/team/
   replace /domains/user-option/ by /domains/bia-domains/user-option/

   replace /features/background-task/ by /features/bia-features/background-task/
   replace /features/notifications/ by /features/bia-features/notifications/
   replace /features/users/ by /features/bia-features/users/
   replace /features/users-from-directory/ by /features/bia-features/users-from-directory/

   replace import { loadAllUserOptions } by import { DomainUserOptionsActions }
   replace loadAllUserOptions by DomainUserOptionsActions.loadAll

   replace import { loadAllRoleOptions } by import { DomainRoleOptionsActions }
   replace loadAllRoleOptions by DomainRoleOptionsActions.loadAll

   replace import { loadAllNotificationTypeOptions } by import { DomainNotificationTypeOptionsActions }
   replace loadAllNotificationTypeOptions by DomainNotificationTypeOptionsActions.loadAll

   replace import { loadAllLanguageOptions } by import { DomainLanguageOptionsActions }
   replace loadAllLanguageOptions by DomainLanguageOptionsActions.loadAll

   replace import { loadDomainAppSettings } by import { DomainAppSettingsActions }
   replace loadDomainAppSettings by DomainAppSettingsActions.loadAll

=> some import should be resolve manualy

## MANUAL STEPS
### FRONT
1. replace ```this.authService.getAdditionalInfos().userData.currentSiteId.toString()``` by ```this.authService.getCurrentTeamId(TeamTypeId.Site)```
   and resolve using

2. replace ```this.authService.getCurrentSiteId()``` by ```this.authService.getCurrentTeamId(TeamTypeId.Site)```
   and resolve using
 
3. replace ```userData.CurrentSiteId``` by ```userData.GetCurrentTeamId((int)TeamTypeId.Site)```
   and resolve using
   
4. search ```<bia-table ```
   if [canEdit] is not parameter and and and (edit) function exist add:
   ```[canEdit] = true```

5. search ```this.repository.Update```
   Normaly there are useless and can be commented: If the item updated come form a EF request you can comment this call.
   Else you can use the function ```this.repository.SetModified```.

6. If you use the Database handler feature verifiy it is still active in bianet.config of the workerservice.

7. search useView = true or tableStateKey = ' (and here an not empty string)
   * This correspond to the feature where view are used.
   * You should add in the corresponding *index.conmponent.html in bia-table-controller the parameter :
     * [useViewTeamWithTypeId]="1"   
     (1 correspond to the Site TeamTypeId)

### BACK

## BUILD 
no change

## DEPLOY
1. The secret key shoul now be passed at the deployement of the service:
   * Change the version of the task "BIA Deploy Service as Web" used the V2